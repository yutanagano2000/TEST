# テストコード採点基準

## 概要

このドキュメントは、Java テストコード（JUnit 5 + Mockito）の採点基準を定義しています。
合計 100 点満点で評価します。

---

## 採点カテゴリ

### カテゴリ 1: コンパイル可能性（25 点）

| 項目               | 配点  | 評価基準                                                                                                |
| ------------------ | ----- | ------------------------------------------------------------------------------------------------------- |
| **構文エラーなし** | 10 点 | メソッド呼び出しの括弧、セミコロン、基本的な構文が正しい                                                |
| **型の一貫性**     | 15 点 | `int` vs `Long`の統一、リテラル（`1` vs `1L`）の統一、Optional の正しい使用、引数の型と戻り値の型の一致 |

#### 減点例

- メソッド呼び出しの括弧不足（`getName` → `getName()`）: -5 点
- 型の不一致（`1` vs `1L`の混在）: -3 点/箇所
- `Optional.empty()`の誤り（`Optional.of(empty)`など）: -5 点
- 引数の型とメソッドシグネチャの不一致: -5 点

#### 型の一貫性（15 点）の詳細評価基準

**1. 数値型の統一（5 点）**

- `int` vs `Long`の一貫性
- リテラルの統一（`1` vs `1L`）
- ID フィールドは`Long`型で統一

**2. Optional の正しい使用（5 点）**

- `Optional.empty()` vs `Optional.of(...)`
- `Optional.of(List.of())`の誤用チェック
- Optional の型パラメータの一致

**3. メソッドシグネチャの一致（5 点）**

- メソッド呼び出しの引数の型が一致
- 戻り値の型の理解
- Repository インターフェースと実装の型の一致

**減点例（詳細）**

| 誤り                                                         | 減点       |
| ------------------------------------------------------------ | ---------- |
| `1`と`1L`の混在                                              | -3 点/箇所 |
| `int`と`Long`の混在                                          | -5 点      |
| `Optional.empty()`の誤り                                     | -5 点      |
| メソッド引数の型不一致                                       | -3 点/箇所 |
| Repository メソッド名の不一致（`findById` vs `getUserById`） | -2 点      |

---

### カテゴリ 2: テストの構造と設計（20 点）

| 項目                           | 配点  | 評価基準                                                              |
| ------------------------------ | ----- | --------------------------------------------------------------------- |
| **アノテーションの正確性**     | 5 点  | `@Test`, `@ExtendWith`, `@Mock`, `@InjectMocks`が正しく使用されている |
| **AAA パターンの使用**         | 10 点 | `// Arrange`, `// Act`, `// Assert`のコメントが適切に配置されている   |
| **クラス・メソッド名の適切性** | 5 点  | テストクラス名、メソッド名が意図を明確に表現している                  |

#### 評価例

- AAA パターン完璧: 10 点
- 一部のテストに AAA パターンがない: -3 点/テスト
- `@Test`アノテーションがない: -5 点

---

### カテゴリ 3: コードの正確性（25 点）

| 項目                   | 配点  | 評価基準                                              |
| ---------------------- | ----- | ----------------------------------------------------- |
| **モックの正しい使用** | 10 点 | `when().thenReturn()`, `Optional.empty()`の正しい使用 |
| **例外テストの書き方** | 10 点 | `assertThrows(Class.class, () -> ...)`の正しい形式    |
| **ロジックの正確性**   | 5 点  | テストメソッド名と実装の一致、ビジネスロジックの理解  |

#### 減点例

- `Optional.empty()`の誤り（`Optional.of(empty)`など）: -5 点
- `assertThrows`のラムダ式不足: -10 点
- 更新メソッドで登録メソッドを呼ぶ: -5 点
- モックの設定と実際の呼び出しが不一致: -5 点

---

### カテゴリ 4: テストの完全性（15 点）

| 項目                     | 配点  | 評価基準                                                               |
| ------------------------ | ----- | ---------------------------------------------------------------------- |
| **テストケースの網羅性** | 10 点 | 要件に定義されたすべてのテストケースが実装されている                   |
| **アサーションの適切性** | 5 点  | 期待値と実際値の検証が適切（`assertEquals` vs `assertTrue`の使い分け） |

#### 評価例

- 全テストケース実装: 10 点
- 1 つ未実装: -3 点
- アサーションメッセージがない: -1 点（オプション）

---

### カテゴリ 5: コード品質（10 点）

| 項目             | 配点 | 評価基準                                   |
| ---------------- | ---- | ------------------------------------------ |
| **スペルミス**   | 5 点 | クラス名、メソッド名、変数名のスペルが正確 |
| **コードの整理** | 5 点 | 不要な空行、重複コードがない、読みやすい   |

#### 減点例

- スペルミス 1 箇所: -2 点
- 不要な空行が多い: -1 点

---

### カテゴリ 6: ドキュメント・コメント（5 点）

| 項目                 | 配点 | 評価基準                                         |
| -------------------- | ---- | ------------------------------------------------ |
| **コメントの適切性** | 5 点 | 意図の説明、クラス構造の説明が適切（過不足なく） |

#### 評価例

- 適切なコメント: 5 点
- コメント不足: -2 点
- コメントが過多: -1 点

---

## 採点表テンプレート

```markdown
## 採点結果：XX 点 / 100 点

### カテゴリ別評価

| カテゴリ                  | 満点  | 得点  | コメント         |
| ------------------------- | ----- | ----- | ---------------- |
| 1. コンパイル可能性       | 25 点 | XX 点 | 型の一貫性に注意 |
| 2. テストの構造と設計     | 20 点 | XX 点 |                  |
| 3. コードの正確性         | 25 点 | XX 点 |                  |
| 4. テストの完全性         | 15 点 | XX 点 |                  |
| 5. コード品質             | 10 点 | XX 点 |                  |
| 6. ドキュメント・コメント | 5 点  | XX 点 |                  |

### 詳細な評価

#### カテゴリ 1: コンパイル可能性（XX 点/25 点）

- ✅ 構文: OK（または問題点）
- ✅ 型の一貫性: OK（または問題点）
  - 数値型の統一: OK / 問題点
  - Optional の使用: OK / 問題点
  - メソッドシグネチャ: OK / 問題点

#### カテゴリ 2: テストの構造と設計（XX 点/20 点）

- ✅ アノテーション: OK
- ✅ AAA パターン: OK（または改善点）
- ✅ 命名: OK

#### カテゴリ 3: コードの正確性（XX 点/25 点）

- ✅ モックの使用: OK（または問題点）
- ✅ 例外テスト: OK（または問題点）
- ✅ ロジック: OK（または問題点）

#### カテゴリ 4: テストの完全性（XX 点/15 点）

- ✅ テストケースの網羅性: OK
- ✅ アサーション: OK

#### カテゴリ 5: コード品質（XX 点/10 点）

- ✅ スペルミス: OK
- ✅ コード整理: OK

#### カテゴリ 6: ドキュメント・コメント（XX 点/5 点）

- ✅ コメント: OK
```

---

## グレード評価

| 点数      | 評価        | 説明                                       |
| --------- | ----------- | ------------------------------------------ |
| 90-100 点 | S（優秀）   | 実務でも通用するレベル                     |
| 80-89 点  | A（良好）   | ほぼ完璧、細かい改善点のみ                 |
| 70-79 点  | B（可）     | 基本的な実装はできている、重要な修正が必要 |
| 60-69 点  | C（要改善） | 基本的な構造はあるが、誤りが多い           |
| 60 点未満 | D（不合格） | 根本的な理解が必要                         |

---

## 採点時の注意事項

### 優先順位

1. **コンパイルエラー（カテゴリ 1）**は最優先で評価
2. **例外テストの書き方（カテゴリ 3）**は重要
3. **スペルミス（カテゴリ 5）**は軽微だが積み重ねに注意

### 柔軟性

- 学習段階に応じて配点を調整可能
- 特定のカテゴリを重視する場合は、他のカテゴリから配点を調整

### フィードバック

- 各カテゴリで具体的な改善点を提示
- 減点理由を明確に説明

---

## よくある間違いと減点

### コンパイルエラー関連

- ❌ `getName` → ✅ `getName()`（メソッド呼び出し）
- ❌ `1` vs `1L`の混在 → ✅ 型を統一
- ❌ `Optional.of(empty)` → ✅ `Optional.empty()`

### 例外テスト関連

- ❌ `assertThrows(Exception.class, service.method())` → ✅ `assertThrows(Exception.class, () -> service.method())`

### ロジック関連

- ❌ 更新メソッドで登録メソッドを呼ぶ → ✅ 適切なメソッドを使用
- ❌ モックの設定と実際の呼び出しが不一致 → ✅ 一致させる

---

## 更新履歴

- 初版作成日: 2024 年
- 最終更新日: 2024 年
- 変更内容: インポートの完全性を削除し、型の一貫性の配点を 15 点に増加
